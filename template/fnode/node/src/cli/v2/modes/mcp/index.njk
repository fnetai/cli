{# ============================================================================
   MCP MODE - MAIN
   ============================================================================
   Model Context Protocol mode orchestrator
   Supports multiple transports: STDIO, HTTP (future: WebSocket, SSE, gRPC)
   ============================================================================ #}

if (cliMode === 'mcp') {
  // MCP mode code
  {% include "./server-setup.njk" %}
  {% include "./tool-handlers.njk" %}

  // Get transport type from arguments
  const transportType = args['mcp-transport'] || args.mcp_transport || 'stdio';
  let transport;

  if (transportType === 'stdio') {
    {% include "./transport-stdio.njk" %}
  } else if (transportType === 'http') {
    {% include "./transport-http.njk" %}
  } else {
    console.error(`Unknown MCP transport type: ${transportType}`);
    console.error(`Supported types: stdio, http`);
    process.exit(1);
  }

  await server.connect(transport);
  return;
}

